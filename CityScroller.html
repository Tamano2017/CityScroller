<html>
  <head>
    <title>CityScroller</title>
    <script src="http://cloud.github.com/downloads/processing-js/processing-js/processing-1.4.1.min.js"></script>
    <script type="text/processing" data-processing-target="mycanvas">
        // Declare and contruct two objects (h1, h2) from the class HorizontalLine 
        
        // Declare and contruct two objects (h1, h2) from the class HorizontalLine
        
        int WINDOW_WIDTH = 600;
        int WINDOW_HEIGHT = 600;
        int RIGHT_ARROW = 39;
        int LEFT_ARROW = 37;
        Skyline slowSkyline = new Skyline(3); 
        
        int REFRESH_RATE_PER_SECOND = 30;
        int GREY = 204;
        //runs once at the start of the program 
        void setup() 
        {
        
          size(WINDOW_WIDTH, WINDOW_HEIGHT);
        
          slowSkyline.addSkyline();

        
        }
        
        
        //called repeatedly 
        void draw() { 
        
          background(GREY);

          slowSkyline.drawSkyline();
          if (keyPressed && keyCode == RIGHT_ARROW) {
              slowSkyline.updateAndRefill();
            }
      


          
        } 
        
         
        
        class Building { 
          
          //attributes
          float By, Bx, Bw, s; 
        
          //constructor 
          Building(float BuildingY, float BuildingX, float BuildingW, float speed) {  
        
            By = BuildingY; 
        
            Bx = BuildingX; 

            Bw = BuildingW;

            s = speed;

          } 
          
          
          void drawBuilding() 
          {
          fill(65,65,65);
          rect(Bx, By, Bw, height-By);
      }
          void drawTower(){
          rect(Bx+Bw/4, By-30, Bw/2, 30);
          rect(Bx+Bw/2.1, By-70, 5,40);
          }
          void update(){
          Bx-=s;
          }

        
        }
        class Skyline{
          var xPos;
          ArrayList<Building> BuildingList; 
          var bw;
          float SkyS;
    
          Skyline(float SkySpeed) {  
            xPos = 0;
            SkyS = SkySpeed;
            BuildingList = new ArrayList<Building>();
          }
          

          void addBuilding() 
            { 
              bw = random(50,150);
              BuildingList.add(new Building(random(50,250),xPos,bw,SkyS));
              xPos += bw + 10;
            } 
            void addSkyline(){
            while (xPos < width){
            addBuilding();
            }
            }

            void drawSkyline(){
            for(var z = 0; z < BuildingList.size(); z++) {
              Building currentBuilding = BuildingList.get(z);
              currentBuilding.drawBuilding();
              if((z+1) % 3 == 0){
              currentBuilding.drawTower();

              }

            }
          
          }

          void updateAndRefill(){
          for(var i = 0; i < BuildingList.size(); i++) {
              Building currentBuilding = BuildingList.get(i);
              currentBuilding.update();
              }
          if (xPos > width - 100){
          addBuilding();
          }


            }

          }
    

        
  
        </script> 
    </head>
    
    <body>
    <canvas id="mycanvas"></canvas>
  </body>
</html>